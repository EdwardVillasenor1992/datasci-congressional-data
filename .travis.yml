language: python
virtualenv:
  system_site_packages: false
python:
- 3.6
services:
- postgresql
env:
  matrix:
  - DJANGO_SETTINGS_MODULE=congressionaldata.settings.local
  global:
  - secure: or2zkEVnICLasEI+98NJi4/Ke6ujHHlHeloQNmgqbD4CRodGONClruK7tudu8cnWGokJpeDKFOz3b9sqjk2+xy5NP6tpaD780nTwOPC+8F0NBJmNZaEdcTa/x8SDTIXjzdX1U9+FABuP8hDTdmym2g91QNhnwBMmApS87dgHPPnlyexQRCA21UO7b/GHqg+tQnnz6mhGXTDy03c2GUXs1GZtuf+pUMLiWNoWyhr84YemJ7PITDADmp0qEDpKHOHwzfZattkj3IWLFL+fj+m7SrY25I6x74PCzB81As9AgNWrVNc2LFjprl1pz9LLFZxcKqPDN8ABejdNYjQsW64b25Ivd2bVSOu6yGtB9sgXO+Griw14uIj5bPyv6+oNApFeyvnRJMp3tvrps9CFUI3FkMiqw8t4yUkwRNEuA2ilE9bLzNoABZe4fJ2Ub/qPQE7s3nfcfQ5L+jgIX7tjoG3IWeNFtBLG9XtnH16PT6X9zbHftWCUBMXLoRAp3vHbfaDj4eMr79mfju+OHXWUnvOlGmN6UtLo3b7kXjmq9+HbCU/hYXSs9fnRkG21LxIsNoAfsqCPWQKvf4Zd53iRxuXcyL8hGufUWAvXtxDA9c/MGdB8VMHcniC7sMw9axZJZVfWsWEaJkiq5bnBIViptELMa5l4XSQr6ZvX978OmGrIaIU=
  - secure: WIQEwqfhMTd021Q20/LTh9XHCWOSdLlQz2uk4HuCxUFQ2EIqQTDq9+GKofGQ8nnLDmtc0ffeZZgv9n6DEbDp6Y/rroRHBGkhg5cSdVX0BE/Tf6wikH+99OrXLqfH0WYIRaIDuh1kowbZElU7GKbz2WzkvYj1n6cBpyMZduLNk8rmI88JrEh2SbkYqvcmSl91xYr4sg0o8s+ZFSPA0ySAmkXxONuUSM7rZKzCtjEaZp3mM7s1wYvP6rnWt1Lm4r9xdmtaYgyq01hMOG2RSAtzIO/Thszw5/ej3kQTvDEI6BYWjw1c9FtCP+1YB/KtVRgaq5iWdjQIVfbiz+1uu6srEqL5X7h7cZrq1LkGIjdNMyHwYjpAMgLiOJ+nfdp82OnZZ0KHvErzgjTI/pGDrGRGDr9ogRkObZb3Iv4r7DBUN9YYUjSEceAXAIeHnIgulAu66CpEwO65xxvYBybzFDpmqr2SAl0JFd/BRqs4pHrXt2cpcDMfa7jlsV83+Sw+pkFg4aX9kGbOIY79Jgn4UHJbYr0q3B76iHyPap57ZqZjxpXyXqZbqX2ro0QbS8cizpVJZfcmDd3idnO2Lwndsg18plTJB9b0Zm6MSiAR/2jz36y64q5KkfflI4qHKTAMwiAfxYAHkMnCnpY3Z+1xCemvNjZ65PHFtV+gRLFnKye8YLQ=
  - secure: WeUoq2nqzjWagplWiPMsoy0e9RPxQvjuhAS5wheFSjGpcEOtQDBKYe6sIjXUNDKuCfch3FMqzzPtM/v4miyLW8y8sv9yUQrcKTQ054Egyd403oRQ0hJQfBs3TQU+iiNW1Vrhv38ajQ0eg56WpZX/Y/VTf4OvTGHPVtmt2wIicjoEiqF+RdUvMRLBGj0b92zohszXgck2OADu2w+NJNsrAAULwkJTD5LUjK2rLOdJBOQUhiUPAeRL9HiBUao2Lf+vCIUXD+HxiECeDCVQZKPBsDhKt7jyhOsIOiwubcYasH+7DphG+jhYVA5fJtzwUfguB1e2VbQFAyogrp9rlEB8yttUdIZq0JZNKB5jZeLzJ5wcF2ggSUSKm7sT3W5/RiGz8nWquCKaBDlB8fomSx7K6V/u5pxIGB2UkW9PuF7KqmcKgpz0zrzrk/U83q8hhyIlGgrVnVVRLfsFDTj564xzMROnLLDHYpiMJfWB+W0DfxBayolWkTsNMTEQv12z97NkOwRcrHfPCLfbT/98jDAwazPd7uOc8bBD1JPbzdmX1feiTC44fZcnMTsCcc3uVQ0ZrxBhpdRaZrZTC2NHJBN8MUUkjHZEPigVN6IFw2fWWMiiDzi7D/7rqzBi+sCWWNDAYfB/qqbrpWfp4SbqYU0zL1kHZ6+4hRsLauwuy9C2cXc=
  - secure: VZAKxjJgM0ag5+9RLhPr1Rangv651/lUzXUR+VQt6lw20gtfZKeqaB68Jt9c6uWXSfU3REZ2MD8c9wlY50dRQhh22knfW03orzsLEJ488IKwdcwj+K3NE+d3VDXWM+AmZhNf0L1DZ56gPzpYRrxeGIh7WU/2P19S8xEAcZ/rbE/ZzIaqs5SNxSpe7/qORPKdSAVjbv5p2NwqxRRWRCW1saxjJ6P3arjl6lCyCanT4JWtcMH2NEdsNfdS9Gk3/6WVtXn5GyFx0NdDH4Wggq0dalqA/jsh0Y6Qun6fLko3Am5AV1ewZDR3oJheUdo13phBRM37+PPtmO4IVtlDX9RYE7MGo/q33HwavPcPNj3DrIK+qtCt3Cm+bRvRKPXb1FJ1Z0NWLDaN020zU9uLDY8tl5bu0B3X7msFmVtjs85TPcxfOWLR5zQIDow4r3xbKTOcSiZKM7VfZuYUGppAMo4YLm6V6s5Mik5Y2LEw7FMa3G89kRP/2ods/c9DwTaWNJgsn623BaU22P/cK0WclokX5qSPdxpdDKS1TrZ1Jr+Dlmuld2mC9/UyPvSwXAcpPXOyzukcVco1QJ6moPrDKjBrbSkZY+nzlthC2yUwxhtUMxrUBRYezM0dv7ThjOripCc9nhEULzLcoCCvq9OsiiwV6Dnq+e05rQtfMLXWqvlDDxA=
  - secure: XT7BI9Q0D6FLIaVjNgxRkqIK3qH2sHnqZ73Kou/c4fBevbruP6CxT/YV03W1gtjPdhkmZvIrxIju5b5F7ZpDmLCGuH0qfWGBVQyeD23N9jRpCofFsZ/Eijug5z9X4eWloRtxhmyyICYG641Na1vj4M+jdBv31N3/mh3bm1MfP4dsIwrSCp5paPGHxFHFyjYOqhg4anJLpF0ru3/w3+UVvAc6Xn0ky7/jdMCtTpbT8mtfOOtzfYY570JMXHumGHef7xRtLfMYW/9hE7GLWgvN8VvHTDznAOYOK5hwJTkQA+aJf5pWVjk7TxmuVeYs9j9k3OX5SSp2m9KDQyJLHAO3bZnTusg/PJADL5x1Lq6jX2Mmk1xnejG4fyNVup7cCjhuXg4jtxiEch2tzPqvOlTwJ29+TsBjSy8Rof8uJWt7Twm1cJybQM8KF6Kfn1Wno+oyerS/WGS7UEDzyIDrlDW9sRVUskQCg0FDyCUPBG4S8xuKlfjNao35Jif+aOr62ELCkZIdNxImXOWXgRlfiQ9A0oFFTr5AvQ+g2mPKMD2yAIyHLMjF4A1xWYiu7KhGQ/xrdCet1VQlPPZx0hqtYo3HeQMA/lIvrfQqK6X1xC3oSafBB8FEIehRdUVRp94pI5i4nmZxFDxPAoRED09Nj99I18AHDWmjle7xFsEVZURNVOM=
  - secure: eRrxEyEDRz5oDjejr1pENmUex8NDoShPyO7/DIevcnANQO35xQLTjhY0+FtNGXCRVZ6h7yE2+uTp4u++FX/q/yIhU4bbiFJI7+Fnif/zoUWSY63mwBWhfmg1zLs8X9aWsw5hoBaZI8gc5/qCxsNF/Z5ChcpWnfdWdY2JuOPbcYKs/hqLdNIzF5s92rEkBbpb3kZ/bSPXJ8DVOqjLQMm6NQbKY9OYlYV1ZegR/uQXzQRAkiOqWL0F3Nm4UQkYDhvLPsHz2B66PQONI8BHm4Cf3QsHDf/uUXI6TdKdaEKzKSp8jy1JmeclvzDX4y1hRMOEZ4K2V/6u/dYwU4Gy3YhhHtKG34c8ciTyI3Yd8KdZ2tXglvaA58+MRmS4dfOeKRVNBPLpJQunVP6APsyzUApZzuLRwDzKEDN51+EELNJnwsO+ZAXUVaigmLwLHrh5vheozV6SCYGfNUIb+o+dJyaLKBq5t3vCKNasiz3AqnAiPDdn3g46hCU1LEV5Cfk6inaNTGZalmQx9gfDB+I1xH3gACPXlYO7u/sWaYcvOtu49lmoTGI80itvS+Jgr8b8BVhZYe5yVQ8boqkcyN2a42J3pCXiO/sX7cONt8j4aCuf3n4pCA9a/Si0MtyFeZdkL3Jj6qRTBGkD7rCnf2n7i//j+BbecIFEBoPnE6eZ0fuI3z8=
  - secure: Zl41eOMsijApiY4VJHcIJtESWDiqJBhyf7JpJj1zBatbTmHpAzbLXkAe2l1cKhVPh4UQwm2YiOtE0i24l860Lxd3fYhg1tS1Bntxu83G8UM3NSJOHvrdBh2XeLu/s5ttdHMPVHBcTUFuFdTXQBCszAeuvQgMn47QIcrZhCjP/F8782JmLpqm1VUA9YGGfVCoPjJt0jZwZKxrmleC9/w6sGiHpxYMORQGZQVu7e5M0VdfzkSiJxefszEys0xzTiZb0HywHNWTm+km7hJ7vYb9i5p30QPeTQ7Jc2NVSm7PA3sIjsN0wgxCNHI3vQ9NiLW4fGc419WEl6F1d8V4eH7h2MpTmZKcQCGfMI+qj9COi/w+iHpHrJbDlFlxGu3ieWhbWrkMV3eGbQPjl2N+GPiGakuh2JV4tZyh0QAWda9ARJSiT7HhF+FijMIt1FoKmxed2n5wdhJglVCuQM5A8RuROGOiir6N8OqS6GsbMI18ox2csrFepDNccOChvKhoU3jSK+zS5ebqoRJUVHJK96wp8wSP8LkDAvFyJDMsLr3Ecs2ApbeNylRhwVS3hwrAFkkf7Jhr2Rkx2oVS6A+UYWsWieYsAShNIaQ7XznSe4II51pUBH7oJIg9EYOF6ucOH5pQi5YwvAWO7vNPb5i+cRYaAuLyd3QPL3Ql305+sXA/5vc=
  - secure: VUOSXiuXnZ7rlpo7mHajFiv4P1WLZbEIKZFnSgldv8wmRqCMojOCS0L7J70jNFeDMxDhwyqNHvJ3QvmkhDkVO/zDXQwL1rb5zyEJTXYovXmxAV8ApW52zSF3C4ZgPk6QNMuhPgdQDQyVa8VYcyCF9CN9LjsogHZv58lD2Cmk+sCiZfd8AzcvLzvjlNgvHyjnjd8G1vhT/5YzLqVVltYPLgHYWSDITllOh+jbAiCEX0SWCAaPwmZvsTB2t4ACLaYCjL3a7vV8PalS5P7SfpIeUdrzynSWhTTu9YNHtTuA9Nga6hzhEZn0GinOY+LOjLe5nK9WrQJihiTceiM79hS7TuO/ikptXX1ycnN64VRS4I3/F4dOclFzleGiITSfKmVeSInJ6qMbv5vutWpGCt5oWQlHjBS46cJbJjQKzogRD971yJQm6OOPPC+70p3DL8xA5LHWbV4B7fQYQoLgLJAstKRNgFHP6AeqZXn13uIKyLwN4BkjPh8BgFmGAEgV9mJIUL24udbP89322IfwY4+mC0siuAvRIkgutOZ5KlhUeX4maADTS4JdOs8ZjolG1odV8qi13jpXE6ExgEDlT4efoACaAv/ZzhlcVDJ3aZ60Mid30U8GLWKyllsvYxfcLWt+ajwc82D12HTQnfR7fNszXJWg8fEanAyKNx4YEyh07oo=
  - secure: CQq0ug7WVz1pMImlDe+Gf9KoFTQbsLuWkK9g+hx7pLRx9WPXyMOQcUkEghbJpoINqpnIdxJfbhuDFtmEeiLgMRLXhjWK8NcaPGDY6ORtk73zKzIUonZynuRU4RSc3Q//Grf6cfKVmTRMKSOFZgQkfD1Yh3Bfo5RpAtTsXgSrqehZRInNHIs5MMEsEoT+f+aweN4C0LIZGeWrRqlk8UUYoEsBt9gh3mFrLM1LQNYkYawJLo4AzgNvHSKWn6Vbs7/w8fegXg47G0P7Hl9fAA7Texj1UACZ7oDj/kFUF2Em4BM2ACSG/ZowdycHNoYPK8GaRqaUHKDGtv4XJt6i8QJ8Al6TtH7YE6zV8NU9R65yfoDBXb+DWu5/eTOr8+F0h7PpNUQeRJ3kqcUiPe9rqd1dKfVwFWc8DztJ5kEzug+XdQePszDqnIvNcUT5esZS0ywVBH/5VHdxQ199NYIIv0s6nMxqqgVGjLo9yuLq/xfaVneq5qfKgHu25Rw4LPPYlwjDLHByme3F56wnck0im96AaJVNie/XO/OVbssQ8fLphBIt85EqkoMt6xa0EkUfbBlUNtE+9Z1Z/9deAX6JMnrp5xkTp/+IOj73pNaWEgC9SGvP5ktHpVYdQD90UacZi1qVsUPMDD4pJwd5bnUDJgRhhpxhFZ5lWQ86svfjhNFB8LY=
  - secure: heGcGi9j0AGSfVehNDSsY2UJl7HEEkp9dcWnUGYi+NmTQDGfuxYZbroHR+Y7xLaWiLHVtwt96YZLE84FsBcr0yo4edkiOd75GvHeRVE3d3ZWgM6aFaKdaN9Q0DT40yS/5/4Rc/fRS1PxmDUna0PwTjyc8dmGoNCBqbTZ8CtL3UY0G0O7Hk5Im8Eo9UJLwMrEnqUGmDildnxj5li5UONCCbubW/zimg/vxAV+OSReE6cbE/70/mCz936pvbxUb4ax2HDui5xWd3P4vmgrdzMbKScetbw1L2wrFwnCE+w5kCtlwqXXqXgmT7Ogf6J2J/TrUGLPO/RkD5jBx+pyjo2cggMV/5GL2xyTKZq/nmEePgl85DHah74rsoSwmpYvZ2kk7LaHEzLBuLNIiODRKeVz3xFxMZNvO2inxfDVTejKU2g0sXWCAPyBRbs3o6d1C+vsX9ZGaVTXbHExheMOZLRudDOTDH0dqQGud+q/HFTrdlqknbwVxo7otFnvafzB6q9mNYHhY6EJZW9PnOa69T6XXtnR4eUdCxYK1EGbkn+HZH8sCT3r5J9s9eyeeoIZzPFbU1EWCU1vEUHdJxsK4xx1TSQBzzsGUJI7tizAflKBbEVHRY7RQuChhzBCWwx1Xelx0Pb4lwdCps3DQ6ee297R6au1ZH8xQ8t+zvkdRx+MMuE=
  - secure: cCqwtps1IY3vCRhodwJneXZOPNFB6SI237d9pkr5s5TILpyjNK8blUTBfkxlMAJCD/xRlvSp4FfKFDNhIWLtgditzrpkYl7EZNADlDVmRzEs/0clBYeRw4JLOCM9gx8FLFo4C+51clc6oG3SUo+1NnReQlmvGGcpc/HxSc5ZSZe1vMB+DEEQjqQvKnEkgGKsqo1ob2XqXpCXETwK7y/l/3sZhwogTbKknKi7rKGpVdxVDqRiyijpjvQPJv8+bxxE5OuoNPIM015wqmdyB36DI2MstXegXgF783twkxFtwqWul/CaXMTuj3iZU+icsVmSnexO7CLpkj0XN2WECuGTIkwhxKFrhKGHv4RmK0cqfYdkJdxr3cKZ02Q3YxZyHBQPXAgFguQowVl6027onZtLYQ6LsvaG6uynUU7Ujhr9WMF5/HLkiIdx9O6icPT8WZFYb5aQ0VeDyHQu2WeDtnVxaRwz/SIsJEA0p0hUNYX/qEDBN+6lejqdQtFCJgTkkv/e0CeBlKB322uEMb8Bu8bhS1bOZAOFFhJ2MJ3w93K3WWsb+wzl23dNN7r84/A6jU/4O1ZB0TTdwLrJ0P6dXgRwiA2saiJX0+Bdq3HiF5rwSGLTKpGcZFzUR2oZufpn6IoTTO/3RHIowx1YQj7vsLJUh9axIyelz5aW+zFoKDsKbgE=
  - secure: cGcmKPCN+4tVdwRBf4BoPGWAA3utbiKp/5zDM7fZrJSBA4lm6zYcqnwo7+KvLONa5HZZLm/HRbUcho3NeCfjuzshkWoiNavm8mzcEVj23dKv407MWTUmOToWNPqQErA0WmnwX8dXCBf/5o0UVq9tX/dBYTvUs+s+IPitZMg0Qv55+d5E0tP3/l55cFm3d+p6/LP1ZFimtkrJ7nAlll3zSYOHLlSZ5FkX5KIEPOQTtEETw/MkcdvVVL4vscKF0ZH9cTVj1ulriFKqXv/x9TUpfwwDRb1GIScmWc0FIdSHtE9gF8l9c7hOggVKDaqTwD0kqJ+0fZDDy9aDlMAQ65Cje+JgrHd6fnDENxoTkrzveVj0xOXt9CgkqB/l+9cftqzY/kZwzFsPlNV/NrTpZj0dSXo2jkrP3c2+BVUnpCAs+gHqZWdcFe612dcfqQdg9ltJ861zsjAhl3RZi3FS0EkZyv2L/8KfjRYz0IyssU1FbGEu/Lwt3X3xeCKVwcYZj4ReW6RvqpAB08f4zQ10SMwF12GKwU15MUKyP+b60ZUt1kRHuS9T+swKngAo4Lamy+m/QmWl8SfOh7hNfj/ugDWD6JX2lLaDcBW4tU9ibKkDqMSmCuFoZSevu3ILjZaemQeoho5rd7LhhrGCaDSv3oUZAOScGZS7hWUlIEu1E/vqr6U=
  - secure: XvuoQSJ02cxsiI9ElKEo1Xy1hLUPzB/bz3njyfN5alh1dKHUa+qsT+kg7JbxOCr4GFKwsBdYLsV2P+5EtwPtN5ijvKYgO3I39NF4qB0wHg5Fvlw0w5CC12kPJ+FB/0aU9SoOPC7pS84gMqTlbyDPlccTS1MFINC1jt+Sl7+4x/Fz1iTwDFS/9oXOyJFLrbuVqofofF+ptaRdJ2ISLXm/opvQoK+I/wtO3HRjZE60dk98VZ7bplEE2E6Eqp6Uh6C6oGe7TF3GQmVjZ/UIjPgkMWylK456hrsdjimENqX11+hCczw2u0w/jO0Vv3UK95Bo8qvv1mET6t9/Rb0rlpqV+pkQPqBI0FvpCM4CvCq/HbAjQ71BC1K+dcqznAEbe5l4VCRlEjRRHg+iY3EpEpJo3/5UqhOiYFBFwPUaMV1L4Zuq7S95jn50kHA6Wq3hqA2V0m3bVObc2OO0j6HNuyfhij3W7yKnwCnSTfS5OkR5bvfaESr0j0hQHOq709zMhdX+K58TNI+ZCgpuxEjiagfLMz7bYtNAVzWdISc4JWY+FlDZApcDFcmz0YE/0E15Qpd6drGmpi/APKUOerIZWiieVfPMTg0itVgPTHWeStpYk1bj/tMCmy8D8l1FXmEDdzS06uK8ipsdLh7VsdoFjWTz4BCekZgPVdHa+cE2jqGqgjk=
before_install:
- cd django/congressionaldata
- pip install virtualenv
- virtualenv venv
- source venv/bin/activate
install:
- echo "$LOCAL_POSTGRES_DATABASE_NAME"
- pip install -r requirements.txt
- pip install -r requirements.txt -t lib
- pip install coverage==4.5.1
- pip install python-coveralls
- pip install pycodestyle
- pip install pylint
before_script:
- psql -c "CREATE DATABASE ${LOCAL_POSTGRES_DATABASE_NAME};" -U postgres
- psql -c "CREATE USER ${LOCAL_POSTGRES_USER} WITH LOGIN PASSWORD '${LOCAL_POSTGRES_PASSWORD}';"
  -U postgres
- psql -c "GRANT ALL PRIVILEGES ON DATABASE ${LOCAL_POSTGRES_DATABASE_NAME} TO ${LOCAL_POSTGRES_USER};"
  -U postgres
- psql -c "ALTER ROLE ${LOCAL_POSTGRES_USER} CREATEDB;" -U postgres
- pylint --output-format=html api congressionaldata election_data > /tmp/pylint-report.html
script:
- coverage run --source='.' manage.py test election_data
- coverage report --omit="*venv*","manage.py"
after_script:
- deactivate
deploy:
- provider: azure_web_apps
  verbose: true
  slot: "${AZURE_WA_SLOT_DEVELOPMENT}"
  on: ci-test
- provider: azure_web_apps
  verbose: true
  slot: "${AZURE_WA_SLOT_DEVELOPMENT}"
  on: develop
- provider: azure_web_apps
  verbose: true
  slot: "${AZURE_WA_SLOT_PRODUCTION}"
  on: master
after_success:
- coveralls
- pycodestyle --exclude=migrations,lib,venv .
notifications:
  slack:
    secure: yX+Aq3TgpyAHmHZvtcEOFxxi+jkej4ppTbD6l5rsAWkbNB2b1mr2/YoVxDX4JGZSDENBmhCztdrlGxiqE8OPcSxod8xTyGTh0MB8uS3L5OoawPWYKtlB1JiTrCcnqU6zxBYp0V1HKIRmTlugi3rMX8HoT4THC0YrEVOtAwF+Oo+VP/YJju9fwLLaV4N6hQdazOE6+WPboEGl5qEQcB2fhW6GwyP1clGp5rH9POX0fcg1zNhnj6XIfqD8IGBRnPFesGREtwLdCMW7ndElfZgIKMKWc8sBrg9DXV3Em83q4bCnlnZncVZUasNTzTKApOB29aRU/dOok3BxzzhWwThxRaE7WW8l6cAUWSflQ9DwHwEkimXOUcV5CePKf2LNzihTAc/s/kT+ZEfkWZ8uHPxbUtatl4xvXr2kJbC4h4XQ09E5I53iSexfnrBYNSGKUPo/Ui0ZL/sArvSIIL6JR4NXjzhC4p+MDW8tGgKsbEMM2ScQsRQLTOS4rIIJD44P883m57RrXLhtVuDexZSFPQyDJu8OBQ2wFJgj1190Ka5/ACfNksczfaQLUwrCOZIg2SFBW07Yx3OOjubqnTFjzMcszu2/7WtxqUc6PmpG9tLFWVIQUR4E3a1Or9P3e+jcRse9i7/6Jl2xqEZape8YJTYSKrYpqTzgUJI5uMoY5O+PMrI=
